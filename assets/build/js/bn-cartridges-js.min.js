function contribGridContents(a){event.preventDefault(),$(".index-grid").hide(),a.style.display="block"}function discoverContentGrid(){$(".index-grid").hide(),$("h2.index-heading").removeClass("active"),$(this).addClass("active"),this.nextElementSibling.style.display="block"}!function(){"m.barnesandnoble.com"!==window.location.hostname&&"mbarnesandnoble.skavaone.com"!==window.location.hostname&&"mpreprod.barnesandnoble.com"!==window.location.hostname&&"mpreview.barnesandnoble.com"!==window.location.hostname||$("head").append('<link rel="stylesheet" type="text/css" href="https://qa-adobe-dispatch.bn-web.com/etc/designs/ccr/static/html/css/bn-cartridges-mobile.min.css">');var a,b,c=function(a){for(var b=window.location.search.substring(1),c=b.split("&"),d=0;d<c.length;d++){var e=c[d].split("=");if(e[0]===a)return e[1]}};a=function(a,c,d,e,f,g){var h;h=a+"="+escape(c)+"; ",d&&(d=b(d),h+="expires="+d+"; "),e&&(h+="path="+e+"; "),f&&(h+="domain="+f+"; "),g&&(h+="secure; "),document.cookie=h},b=function(a){var b=new Date;return new Date(b.getTime()+24*a*60*60*1e3).toUTCString()};var d=!1;"prodny-endeca.bn-web.com"!==window.location.hostname&&"prodny-preview.bn-web.com"!==window.location.hostname&&"localhost"!==window.location.hostname||(d=!0);var e;e=c("date")&&d?new Date(c("date")):new Date,e.setHours(0,0,0);var f=Date.parse(e),g=e.getMonth()+1;1===g.length&&(g="0"+g);var h=e.getDate()+"";1===h.length&&(h="0"+h);e.getFullYear(),new Array("Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday");loadRWDimg=function(a){$("["+a+"]").each(function(b,c){var d=$(this).attr(a);$(this).attr({src:d,alt:"",border:0})})},$(function(){var a=$(window).width();a>1279?loadRWDimg("data-img-src-desktop"):a<600?loadRWDimg("data-img-src-mobile"):loadRWDimg("data-img-src-tablet");var b=!1,c=window.location.pathname.split("/");if("mobile"!==c[1].toLowerCase()&&"m.barnesandnoble.com"!==window.location.hostname&&"mbarnesandnoble.skavaone.com"!==window.location.hostname&&"mpreprod.barnesandnoble.com"!==window.location.hostname&&"mpreview.barnesandnoble.com"!==window.location.hostname||(b=!0),b){$("body").addClass("isMobile"),"series"!==c[2].toLowerCase()&&"series"!==c[3].toLowerCase()||($("body").addClass("mobileSeries"),$("h2.index-heading").addClass("rule"));(function(a){var b=$(a.selector),c=$(b).length,d=c>0&&"carousel"===$(b).first().attr("data-widget-type"),e=1;!d&&c>0&&$(b).each(function(){var b=this,c=$(this).attr("id"),d=$(this).children("li:not(.add-plus-product)").length;getCarouselWidth(this,a);$(this).attr("data-widget-type","carousel"),a.incrementIds&&($(this).attr("id",c+"-"+e),e++),d>a.numDisplay&&($(this).after(a.paginationButtons),a.breadcrumbContainer&&a.pagination&&$(this).after(a.breadcrumbContainer)),$(this).parent().off("click").on("click",".prev-item, .featured-prev-item",function(){$(b).trigger("prev")}),$(this).parent().on("click",".next-item, .featured-next-item",function(){$(b).trigger("next")}),$(this).carouFredSel({align:a.alignItems,responsive:a.responsive,circular:a.circular,height:a.carouselHeight,items:{visible:a.items.visible,width:a.itemWidth,height:a.itemHeight},prev:a.prev,next:a.next,pagination:a.pagination,auto:a.auto,scroll:a.scroll,direction:a.direction}),$(this).swiperight(function(){$(this).trigger("prev")}),$(this).swipeleft(function(){$(this).trigger("next")})})})($.extend({},this.carouFredSelect_cfg_base,{selector:".event-info",alignItems:"left",carouselWidth:"100%",carouselHeight:"variable",items:{height:"auto",width:"auto",visible:{min:1.12}},prevButtonID:"carousel-prev",nextButtonID:"carousel-next",prev:".featured-prev-item",next:".featured-next-item",paginationButtons:'<div id="carousel-pagination" class="featured-item-pagination"></div><div class="featured-prev-item" style="display:block;" id="carousel-prev"><span style="display:none;">Prev</span></div><div class="featured-next-item" id="carousel-next"><span style="display:none;">Next</span></div>',breadcrumbContainer:'<div id="carousel-pagination" class="featured-item-pagination"></div>',pagination:{container:"#carousel-pagination",anchorBuilder:function(a){return' <span data-icon="carousel-pager-off">'+a+"</span>"}},responsive:!0,auto:{play:!1},circular:!0,redrawOnResize:!1})),$("#ec-carouselEventsVideo").carouFredSel({auto:{play:!0,timeoutDuration:3e3},scroll:{items:1}}),$("a.mf-cta").off(),$(".row.featured-link-container .clearfix").remove(),$(".row.featured-link-container").addClass("slick-feat-cat"),$(".slick-feat-cat .genre-tile-footer p").removeClass("genre-tile-caption"),$(".slick-feat-cat").slick({dots:!0,arrows:!1,speed:500,cssEase:"linear",adaptiveHeight:!0,respondTo:"window",infinite:!1}),$(".discoverFeaturedBook").slick("unslick")}else{var d=null,e=null;$(".card a, .event-info-pod").each(function(a){eventExpiration=$(this).data("expiration"),eventEnd=new Date(eventExpiration),eventEnd.setDate(eventEnd.getDate()+1),today=new Date,today>eventEnd&&($(this).addClass("ended"),$(".ended .card-date, .ended .event-info-pod-date").text("This Event Has Passed"),$(".ended .card-title").remove())}),$(".card a").each(function(){if(!$(this).hasClass("ended"))return $(this).addClass("current"),withMe=this.id,e="#info-"+withMe,startSplit=withMe.split("t"),d=startSplit[1]-1,!1;e="#info-spot1",$(".card #info-spot1").addClass("current")});if($(".calendar-bottom-content").length<4&&$(".ec-backward, .ec-forward").remove(),$("#ec-carouselEvents").length&&$("#ec-carouselEvents").carouFredSel({circular:!1,infinite:!1,direction:"left",items:{visible:3,start:d},auto:!1,next:{button:".ec-forward"},prev:{button:".ec-backward"}}),$("div[id^=info-spot]").length,$("div[id^=info-spot]").hide(),$(e).show(),$(".card a").click(function(){var a="#info-"+$(this).attr("id");return $("div[id^=info-spot]").hide(),$(a).show(),$(".card a").removeClass("current"),$(this).addClass("current"),!1}),$(".event-info-pod").length){var g=-1;$(".event-info-pod").each(function(){g=g>$(this).height()?g:$(this).height()}),$(".event-info-pod").each(function(){$(this).height(g)})}$(".lt-ie9").length&&loadRWDimg("data-img-src-lt-ie9")}if($("form#r17TextBookSearch.DT").length&&$("#r17TextBookSearch.DT #siteSearch").keypress(function(a){if(13===a.which){var b=$("form#r17TextBookSearch.DT");b.submit(function(){txtBookQuickSearch()}),txtBookQuickSearch=function(){var a=$.trim($("#r17TextBookSearch.DT #siteSearch").val()).replace(/[\W]/g,"+"),c=location.protocol+"//"+location.hostname+"/s/"+a+"/_/N-8q9";b.attr("action",c),b.attr("method","get")}}}),$("form#r17TextBookSearch.MP").length){var h=$("form#r17TextBookSearch.MP");h.submit(function(){txtBookQuickSearch()}),txtBookQuickSearch=function(){var a=$.trim($("#r17TextBookSearch.MP #siteSearch").val()).replace(/[\W]/g,"+"),b=location.protocol+"//"+location.hostname+"/s/"+a+"/_/N-8q9";h.attr("action",b),h.attr("method","get")},$(".cqTextBookSearch-isbn-link").on("click",function(a){a.preventDefault();var b=($(".cqTextBookSearch-isbn-link"),$(".cqTextBookSearch-isbn-sample").is(":visible"),$(this));return b.hasClass("active")?(b.removeClass("active"),$("#r17TextBookSearch.MP #siteSearch").focus()):b.addClass("active"),!1})}if($("form#cqTextBookSearch").length){var i=$("form#cqTextBookSearch");i.submit(function(){txtBookQuickSearch()}),txtBookQuickSearch=function(){var a=$.trim($("#searchTextBookBar").val()).replace(/[\W]/g,"+"),b=location.protocol+"//"+location.hostname+"/s/"+a+"/_/N-8q9";i.attr("action",b),i.attr("method","get")},$(".cqTextBookSearch-isbn-sample"),$(".cqTextBookSearch-isbn-link").on("click",function(a){a.preventDefault();var b=($(".cqTextBookSearch-isbn-link"),$(".cqTextBookSearch-isbn-sample").is(":visible"),$(this));return b.hasClass("active")?(b.removeClass("active"),$("#searchTextBookBar").focus()):b.addClass("active"),!1})}if($("#jsonGridItems").length&&"undefined"!=typeof jsonGridItems&&$.each(jsonGridItems,function(a){var b=a+1;if(b>0){var c=this.ean,d=this.title.trim(),e=this.contributor.trim(),f=50,g=d;if(d.length>f){var h=d.substr(0,f);h=h.substr(0,Math.min(h.length,h.lastIndexOf(" "))),g=h+"&hellip;"}var i="event_result-grid_"+c+"_image",j="//prodimage.images-bn.com/pimages/"+c+"_p0_v3_s118x184.jpg",k=$('<div class="jsonGridItem"><a href="http://stores.barnesandnoble.com/" onclick="set_cookie('+i+');"><div class="jsonGridImage"><img src="'+j+'" border="0" alt="" /></div><div class="jsonGridDetails"><p class="jsonGridTitle">'+g+'</p><p class="jsonGridContributor">by '+e+"</p></div></a></div>");$("#jsonGridItems").append(k)}}),$("#jsonBFSignedEditions").length&&"undefined"!=typeof jsonSignedEditions){var j=$("#bfAuthorNavPrimary").length>0,k=1,l=(jsonSignedEditions.map(function(a,b){if(b>=0){var c=a.ean,d=a.title.trim(),e=a.contributor.trim(),f=a.section,g="";if(j&&(0===b||b>1&&f!==jsonSignedEditions[b-1].section)){k+=1;var h='<a role="menuitem" aria-setsize="" aria-posinset="'+k+'" href="#'+f+'" class="authorSectionLink" tabindex="0">'+f+"</a>";g='id="'+f+'"',$("#bfAuthorNavPrimary li[data-section="+f+"]").html(h),$("#bfAuthorNavSecondary li[data-section="+f+"]").html(h)}var i=50,l=d;if(d.length>i){var m=d.substr(0,i);m=m.substr(0,Math.min(m.length,m.lastIndexOf(" "))),l=m+"&hellip;"}var n="event_result-grid_"+c+"_image",o="//prodimage.images-bn.com/pimages/"+c+"_p0_v3_s118x184.jpg",p=$("<div "+g+' class="jsonGridItem active sect_'+f+'"><a aria-label="'+d+' - Signed Edition" href="http://stores.barnesandnoble.com/" onclick="set_cookie('+n+');"><div class="jsonGridImage"><img src="'+o+'" border="0" alt="" /></div><div class="jsonGridDetails"><p class="jsonGridContributor">'+e+'</p><p class="jsonGridTitle">'+l+"</p></div></a></div>");$("#jsonBFSignedEditions").append(p)}}),function(a){var b="sect_"+a,c=1e3;"all"===a?($(".jsonGridItem").addClass("active").css("z-index",1).animate({opacity:1},{duration:c,easing:"swing",complete:function(){}}),$("#bfAuthorNavSecondary").fadeIn()):($(".jsonGridItem").each(function(a){$(this).removeClass("active").css("z-index",-1).animate({opacity:0},{duration:0,easing:"swing",complete:function(){}}),$(this).hasClass(b)&&$(this).delay(a).addClass("active").css("z-index",1).animate({opacity:1},{duration:c,easing:"swing",complete:function(){}})}),$("#bfAuthorNavSecondary").fadeOut())});j&&($(".authorSectionLink").attr("aria-setsize",$(".authorSectionLink").length),$("#bfAuthorNavSecondary .authorSectionLink").click(function(a){a.preventDefault();var b=$(this).parent().attr("data-section");$("#bfAuthorNavPrimary .authorSectionLink").removeClass("active"),$("#bfAuthorNavPrimary [data-section="+b+"] .authorSectionLink").addClass("active"),l(b),$("html, body").animate({scrollTop:$("#bfAuthorNavPrimary").offset().top},500)}),$("#bfAuthorNavPrimary .authorSectionLink").click(function(a){a.preventDefault();var b=$(this).parent().attr("data-section");$(".authorSectionLink.active").parent().attr("data-section")!==b&&($("#bfAuthorNavPrimary .authorSectionLink").removeClass("active"),$(this).addClass("active"),l(b))}))}($("#compare").length||$(".comp-price").length||$("#nook-device-price").length)&&$.ajax({url:"//"+window.location.host+"/web-services/nook-devices?format=json",type:"GET",dataType:"text",success:function(a){var b=$.parseJSON(a);$.each(b.mainContent[0].records,function(a){if(a<20){var b=this.attributes["common.id"],c=this.attributes.P_List_Price;c=Math.round(100*c)/100;var d=this.attributes.P_Sale_Price;d=Math.round(100*d)/100;this.attributes.P_Percentage_Save;$("[data-bnprice='"+b+"']").each(function(){$(this).parent().hasClass("comp-price")?(d<c?($(this).html("<s>$"+c+"</s>"),$(this).next().html("$"+d)):$(this).html("$"+d),$(this).attr("data-endeca-price","true")):$(this).html("$"+d)})}})}}),$("#coupn-promo-container").length&&"undefined"!=typeof cp_promo_items&&$.each(cp_promo_items,function(a){var b=a+1,c=!0;if(b<30){var d=this.promoType.trim(),e=this.promoStore.trim(),g=this.promoTitle.trim(),h=this.promoCopy.trim(),i=this.promoURL.trim(),j=this.promoExp.trim(),k="";if(j.length>1){k="Expires&nbsp;"+j;var l=j.split("/");2===l[2].length&&(l[2]=20+l[2]);var m=l[0]+"/"+l[1]+"/"+l[2],n=Date.parse(m);f>n&&(c=!1)}if(c){var o=g.replace(/ /gi,"-").replace(/([^a-z0-9-]+)/gi,"").toLowerCase(),p="'couponsdeals_promotion_"+o+"-shop-now_button'";0===i.indexOf("www.")&&(i="https://"+i);var q=$('<div class="coupon col-lg-6"><div class=" pl-s pt-xs pb-m bd-b-geyser coupon-promo"><a href="'+i+'" onclick="set_cookie('+p+');"><div class="brow text--uppercase color-coal">'+d+" | "+e+'</div><div class="promo-item-name"><div class="header3 color-coal">'+g+'</div><div class="arrow"></div></div><div class="coupon-promo-copy-height text--medium color-coal mt-xxs">'+h+" "+k+'</div><button class="btn btn--medium">Shop Now</button></a></div></div>');$("#coupn-promo-container").append(q)}}});var m=$('<div id="sectionLinkContainer"></div>');$(".isMobile .author-series-indexes--contributor h2.index-heading, .isMobile .author-series-indexes--contributor .index-grid").hide(),$(".isMobile .author-series-indexes--contributor h2.index-heading").each(function(a,b){var c=$(this).text();$(this.nextElementSibling).attr("id","header"+c);var d=a+1,e='<a role="menuitem" aria-setsize="" aria-posinset="'+d+'" href="#header'+c+'" onClick="contribGridContents(header'+c+', false)" class="authorSectionLink" tabindex="0">'+c+"</a>";m.append(e)}),$(".isMobile section.container.mb-xxxl").prepend(m),$(".isMobile #headerA").toggle(),$(".isMobile .authorSectionLink:first-child").toggleClass("active"),$(".authorSectionLink").click(function(){$(".authorSectionLink").removeClass("active"),$(this).toggleClass("active")}),$(".isMobile .author-image-carousel .carousel").slick("unslick"),$(".isMobile .genre-index-refinements--discover-categories div.index-grid").hide(),$(".isMobile .genre-index-refinements--discover-categories h2.index-heading").show(),$(".isMobile .genre-index-refinements--discover-categories h2.index-heading").click(function(){$(this).next(".isMobile .genre-index-refinements--discover-categories div.index-grid").slideToggle(),$(this).toggleClass("active")}),$(".isMobile .genre-index-refinements--discover-categories h2.index-heading").text(function(){return $(this).text().replace(/\bDiscover \b/,"")}),$(".cafe-slick").slick({dots:!0,arrows:!1,speed:500,cssEase:"linear",adaptiveHeight:!0,respondTo:"window",infinite:!1})})}();