!function(){var a=!1,b=window.location.pathname.split("/");"mobile"!==b[1].toLowerCase()&&"gs"!==b[2].toLowerCase()&&"m.barnesandnoble.com"!==window.location.hostname&&"mbarnesandnoble.skavaone.com"!==window.location.hostname&&"mpreprod.barnesandnoble.com"!==window.location.hostname&&"mpreview.barnesandnoble.com"!==window.location.hostname||(a=!0),a&&($("body").addClass("isMobile"),"series"!==b[2].toLowerCase()&&"series"!==b[3].toLowerCase()||$("body").addClass("mobileSeries"),$(function(){$("h2.index-heading").addClass("rule")}));var c,d,e=function(a){for(var b=window.location.search.substring(1),c=b.split("&"),d=0;d<c.length;d++){var e=c[d].split("=");if(e[0]===a)return e[1]}};c=function(a,b,c,e,f,g){var h;h=a+"="+escape(b)+"; ",c&&(c=d(c),h+="expires="+c+"; "),e&&(h+="path="+e+"; "),f&&(h+="domain="+f+"; "),g&&(h+="secure; "),document.cookie=h},d=function(a){var b=new Date;return new Date(b.getTime()+24*a*60*60*1e3).toUTCString()};var f=!1;"prodny-endeca.bn-web.com"!==window.location.hostname&&"prodny-preview.bn-web.com"!==window.location.hostname&&"localhost"!==window.location.hostname||(f=!0);var g;g=e("date")&&f?new Date(e("date")):new Date,g.setHours(0,0,0);var h=Date.parse(g),i=g.getMonth()+1;1===i.length&&(i="0"+i);var j=g.getDate()+"";1===j.length&&(j="0"+j);g.getFullYear(),new Array("Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday");loadRWDimg=function(a){$("["+a+"]").each(function(b,c){var d=$(this).attr(a);$(this).attr({src:d,alt:"",border:0})})},$(function(){var a=$(window).width();a>1279?loadRWDimg("data-img-src-desktop"):a<600?loadRWDimg("data-img-src-mobile"):loadRWDimg("data-img-src-tablet");var b=!1;if("mobile"!==window.location.pathname.split("/")[1].toLowerCase()&&"m.barnesandnoble.com"!==window.location.hostname&&"mbarnesandnoble.skavaone.com"!==window.location.hostname||(b=!0),b)(function(a){var b=$(a.selector),c=$(b).length,d=c>0&&"carousel"===$(b).first().attr("data-widget-type"),e=1;!d&&c>0&&$(b).each(function(){var b=this,c=$(this).attr("id"),d=$(this).children("li:not(.add-plus-product)").length;getCarouselWidth(this,a),$(this).attr("data-widget-type","carousel"),a.incrementIds&&($(this).attr("id",c+"-"+e),e++),d>a.numDisplay&&($(this).after(a.paginationButtons),a.breadcrumbContainer&&a.pagination&&$(this).after(a.breadcrumbContainer)),$(this).parent().off("click").on("click",".prev-item, .featured-prev-item",function(){$(b).trigger("prev")}),$(this).parent().on("click",".next-item, .featured-next-item",function(){$(b).trigger("next")}),$(this).carouFredSel({align:a.alignItems,responsive:a.responsive,circular:a.circular,height:a.carouselHeight,items:{visible:a.items.visible,width:a.itemWidth,height:a.itemHeight},prev:a.prev,next:a.next,pagination:a.pagination,auto:a.auto,scroll:a.scroll,direction:a.direction}),$(this).swiperight(function(){$(this).trigger("prev")}),$(this).swipeleft(function(){$(this).trigger("next")})})})($.extend({},this.carouFredSelect_cfg_base,{selector:".event-info",alignItems:"left",carouselWidth:"100%",carouselHeight:"variable",items:{height:"auto",width:"auto",visible:{min:1.12}},prevButtonID:"carousel-prev",nextButtonID:"carousel-next",prev:".featured-prev-item",next:".featured-next-item",paginationButtons:'<div id="carousel-pagination" class="featured-item-pagination"></div><div class="featured-prev-item" style="display:block;" id="carousel-prev"><span style="display:none;">Prev</span></div><div class="featured-next-item" id="carousel-next"><span style="display:none;">Next</span></div>',breadcrumbContainer:'<div id="carousel-pagination" class="featured-item-pagination"></div>',pagination:{container:"#carousel-pagination",anchorBuilder:function(a){return' <span data-icon="carousel-pager-off">'+a+"</span>"}},responsive:!0,auto:{play:!1},circular:!0,redrawOnResize:!1})),$("#ec-carouselEventsVideo").carouFredSel({auto:{play:!0,timeoutDuration:3e3},scroll:{items:1}}),$("a.mf-cta").off();else{var c=null,d=null;if($(".card a, .event-info-pod").each(function(a){eventExpiration=$(this).data("expiration"),eventEnd=new Date(eventExpiration),eventEnd.setDate(eventEnd.getDate()+1),today=new Date,today>eventEnd&&($(this).addClass("ended"),$(".ended .card-date, .ended .event-info-pod-date").text("This Event Has Passed"),$(".ended .card-title").remove())}),$(".card a").each(function(){if(!$(this).hasClass("ended"))return $(this).addClass("current"),withMe=this.id,d="#info-"+withMe,startSplit=withMe.split("t"),c=startSplit[1]-1,!1;d="#info-spot1",$(".card #info-spot1").addClass("current")}),$(".calendar-bottom-content").length<4&&$(".ec-backward, .ec-forward").remove(),$("#ec-carouselEvents").length&&$("#ec-carouselEvents").carouFredSel({circular:!1,infinite:!1,direction:"left",items:{visible:3,start:c},auto:!1,next:{button:".ec-forward"},prev:{button:".ec-backward"}}),$("div[id^=info-spot]").length,$("div[id^=info-spot]").hide(),$(d).show(),$(".card a").click(function(){var a="#info-"+$(this).attr("id");return $("div[id^=info-spot]").hide(),$(a).show(),$(".card a").removeClass("current"),$(this).addClass("current"),!1}),$(".event-info-pod").length){var e=-1;$(".event-info-pod").each(function(){e=e>$(this).height()?e:$(this).height()}),$(".event-info-pod").each(function(){$(this).height(e)})}$(".lt-ie9").length&&loadRWDimg("data-img-src-lt-ie9")}if($("form#r17TextBookSearch.DT").length&&$("#r17TextBookSearch.DT #siteSearch").keypress(function(a){if(13===a.which){var b=$("form#r17TextBookSearch.DT");b.submit(function(){txtBookQuickSearch()}),txtBookQuickSearch=function(){var a=$.trim($("#r17TextBookSearch.DT #siteSearch").val()).replace(/[\W]/g,"+"),c=location.protocol+"//"+location.hostname+"/s/"+a+"/_/N-8q9";b.attr("action",c),b.attr("method","get")}}}),$("form#r17TextBookSearch.MP").length){var f=$("form#r17TextBookSearch.MP");f.submit(function(){txtBookQuickSearch()}),txtBookQuickSearch=function(){var a=$.trim($("#r17TextBookSearch.MP #siteSearch").val()).replace(/[\W]/g,"+"),b=location.protocol+"//"+location.hostname+"/s/"+a+"/_/N-8q9";f.attr("action",b),f.attr("method","get")},$(".cqTextBookSearch-isbn-link").on("click",function(a){a.preventDefault();var b=($(".cqTextBookSearch-isbn-link"),$(".cqTextBookSearch-isbn-sample").is(":visible"),$(this));return b.hasClass("active")?(b.removeClass("active"),$("#r17TextBookSearch.MP #siteSearch").focus()):b.addClass("active"),!1})}if($("form#cqTextBookSearch").length){var g=$("form#cqTextBookSearch");g.submit(function(){txtBookQuickSearch()}),txtBookQuickSearch=function(){var a=$.trim($("#searchTextBookBar").val()).replace(/[\W]/g,"+"),b=location.protocol+"//"+location.hostname+"/s/"+a+"/_/N-8q9";g.attr("action",b),g.attr("method","get")},$(".cqTextBookSearch-isbn-sample"),$(".cqTextBookSearch-isbn-link").on("click",function(a){a.preventDefault();var b=($(".cqTextBookSearch-isbn-link"),$(".cqTextBookSearch-isbn-sample").is(":visible"),$(this));return b.hasClass("active")?(b.removeClass("active"),$("#searchTextBookBar").focus()):b.addClass("active"),!1})}if($("#jsonGridItems").length&&"undefined"!=typeof jsonGridItems&&$.each(jsonGridItems,function(a){var b=a+1;if(b>0){var c=this.ean,d=this.title.trim(),e=this.contributor.trim(),f=50,g=d;if(d.length>f){var h=d.substr(0,f);h=h.substr(0,Math.min(h.length,h.lastIndexOf(" "))),g=h+"&hellip;"}var i="event_result-grid_"+c+"_image",j="//prodimage.images-bn.com/pimages/"+c+"_p0_v3_s118x184.jpg",k=$('<div class="jsonGridItem"><a href="http://stores.barnesandnoble.com/" onclick="set_cookie('+i+');"><div class="jsonGridImage"><img src="'+j+'" border="0" alt="" /></div><div class="jsonGridDetails"><p class="jsonGridTitle">'+g+'</p><p class="jsonGridContributor">by '+e+"</p></div></a></div>");$("#jsonGridItems").append(k)}}),$("#jsonBFSignedEditions").length&&"undefined"!=typeof jsonSignedEditions){var i=$("#bfAuthorNavPrimary").length>0,j=1,k=(jsonSignedEditions.map(function(a,b){if(b>=0){var c=a.ean,d=a.title.trim(),e=a.contributor.trim(),f=a.section,g="";if(i&&(0===b||b>1&&f!==jsonSignedEditions[b-1].section)){j+=1;var h='<a role="menuitem" aria-setsize="" aria-posinset="'+j+'" href="#'+f+'" class="authorSectionLink" tabindex="0">'+f+"</a>";g='id="'+f+'"',$("#bfAuthorNavPrimary li[data-section="+f+"]").html(h),$("#bfAuthorNavSecondary li[data-section="+f+"]").html(h)}var k=50,l=d;if(d.length>k){var m=d.substr(0,k);m=m.substr(0,Math.min(m.length,m.lastIndexOf(" "))),l=m+"&hellip;"}var n="event_result-grid_"+c+"_image",o="//prodimage.images-bn.com/pimages/"+c+"_p0_v3_s118x184.jpg",p=$("<div "+g+' class="jsonGridItem active sect_'+f+'"><a aria-label="'+d+' - Signed Edition" href="http://stores.barnesandnoble.com/" onclick="set_cookie('+n+');"><div class="jsonGridImage"><img src="'+o+'" border="0" alt="" /></div><div class="jsonGridDetails"><p class="jsonGridContributor">'+e+'</p><p class="jsonGridTitle">'+l+"</p></div></a></div>");$("#jsonBFSignedEditions").append(p)}}),function(a){var b="sect_"+a,c=1e3;"all"===a?($(".jsonGridItem").addClass("active").css("z-index",1).animate({opacity:1},{duration:c,easing:"swing",complete:function(){}}),$("#bfAuthorNavSecondary").fadeIn()):($(".jsonGridItem").each(function(a){$(this).removeClass("active").css("z-index",-1).animate({opacity:0},{duration:0,easing:"swing",complete:function(){}}),$(this).hasClass(b)&&$(this).delay(a).addClass("active").css("z-index",1).animate({opacity:1},{duration:c,easing:"swing",complete:function(){}})}),$("#bfAuthorNavSecondary").fadeOut())});i&&($(".authorSectionLink").attr("aria-setsize",$(".authorSectionLink").length),$("#bfAuthorNavSecondary .authorSectionLink").click(function(a){a.preventDefault();var b=$(this).parent().attr("data-section");$("#bfAuthorNavPrimary .authorSectionLink").removeClass("active"),$("#bfAuthorNavPrimary [data-section="+b+"] .authorSectionLink").addClass("active"),k(b),$("html, body").animate({scrollTop:$("#bfAuthorNavPrimary").offset().top},500)}),$("#bfAuthorNavPrimary .authorSectionLink").click(function(a){a.preventDefault();var b=$(this).parent().attr("data-section");$(".authorSectionLink.active").parent().attr("data-section")!==b&&($("#bfAuthorNavPrimary .authorSectionLink").removeClass("active"),$(this).addClass("active"),k(b))}))}($("#compare").length||$(".comp-price").length||$("#nook-device-price").length)&&$.ajax({url:"//"+window.location.host+"/web-services/nook-devices?format=json",type:"GET",dataType:"text",success:function(a){var b=$.parseJSON(a);$.each(b.mainContent[0].records,function(a){if(a<20){var b=this.attributes["common.id"],c=this.attributes.P_List_Price;c=Math.round(100*c)/100;var d=this.attributes.P_Sale_Price;d=Math.round(100*d)/100;this.attributes.P_Percentage_Save;$("[data-bnprice='"+b+"']").each(function(){$(this).parent().hasClass("comp-price")?(d<c?($(this).html("<s>$"+c+"</s>"),$(this).next().html("$"+d)):$(this).html("$"+d),$(this).attr("data-endeca-price","true")):$(this).html("$"+d)})}})}}),$("#coupn-promo-container").length&&"undefined"!=typeof cp_promo_items&&$.each(cp_promo_items,function(a){var b=a+1,c=!0;if(b<30){var d=this.promoType.trim(),e=this.promoStore.trim(),f=this.promoTitle.trim(),g=this.promoCopy.trim(),i=this.promoURL.trim(),j=this.promoExp.trim(),k="";if(j.length>1){k="Expires&nbsp;"+j;var l=j.split("/");2===l[2].length&&(l[2]=20+l[2]);var m=l[0]+"/"+l[1]+"/"+l[2],n=Date.parse(m);h>n&&(c=!1)}if(c){var o=f.replace(/ /gi,"-").replace(/([^a-z0-9-]+)/gi,"").toLowerCase(),p="'couponsdeals_promotion_"+o+"-shop-now_button'";0===i.indexOf("www.")&&(i="https://"+i);var q=$('<div class="coupon col-lg-6"><div class=" pl-s pt-xs pb-m bd-b-geyser coupon-promo"><a href="'+i+'" onclick="set_cookie('+p+');"><div class="brow text--uppercase color-coal">'+d+" | "+e+'</div><div class="promo-item-name"><div class="header3 color-coal">'+f+'</div><div class="arrow"></div></div><div class="coupon-promo-copy-height text--medium color-coal mt-xxs">'+g+" "+k+'</div><button class="btn btn--medium">Shop Now</button></a></div></div>');$("#coupn-promo-container").append(q)}}})})}();